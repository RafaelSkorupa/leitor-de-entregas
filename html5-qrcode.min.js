!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Html5Qrcode={})}(this,function(t){"use strict";var e,n,r,o,i,a,s;((s=e=e||{})[s.QR_CODE=0]="QR_CODE"),s[s.AZTEC=1]="AZTEC",s[s.CODABAR=2]="CODABAR",s[s.CODE_39=3]="CODE_39",s[s.CODE_93=4]="CODE_93",s[s.CODE_128=5]="CODE_128",s[s.DATA_MATRIX=6]="DATA_MATRIX",s[s.MAXICODE=7]="MAXICODE",s[s.ITF=8]="ITF",s[s.EAN_13=9]="EAN_13",s[s.EAN_8=10]="EAN_8",s[s.PDF_417=11]="PDF_417",s[s.RSS_14=12]="RSS_14",s[s.RSS_EXPANDED=13]="RSS_EXPANDED",s[s.UPC_A=14]="UPC_A",s[s.UPC_E=15]="UPC_E",s[s.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION",s[s.MSI=17]="MSI",s[s.PLESSEY=18]="PLESSEY",s[s.I_2_OF_5=19]="I_2_OF_5",s[s.UNKNOWN=20]="UNKNOWN";var c,l=(((n=l||{}).DEFAULT_WIDTH=300)=="DEFAULT_WIDTH"||n)&&(n.DEFAULT_WIDTH_OR_HEIGHT=230),n.MIN_QR_BOX_SIZE=50,n.SHADED_REGION_CLASS_NAME="html5-qrcode-shaded-region",n.VERBOSE=!!0,n;((c=r=r||{})[c.SUCCESS=0]="SUCCESS",c[c.WARNING=1]="WARNING",c[c.FAILURE=2]="FAILURE";var u=(((o=u||{}).IMPLEMENTATION_TYPE="implementation-type")=="IMPLEMENTATION_TYPE"||o)&&(o.CAMERA="camera"),o.FILE="file",o;function d(t){var e,n,r;return e={},n=t,r=["WIDTH","HEIGHT"],null==n?e:("number"==typeof n?(e.width=n,e.height=n):"object"==typeof n?r.forEach(function(t){Object.prototype.hasOwnProperty.call(n,t.toLowerCase())&&(e[t.toLowerCase()]=n[t.toLowerCase()])}):"string"==typeof n&&(e=JSON.parse(n)),e)}function h(t){return t||2}function p(t){return"object"==typeof t?t:{facingMode:t}}function f(t){var e,n,r;return e={},n=t,r=["fps","qrbox","aspectRatio","disableFlip","videoConstraints"],null==n?e:("object"==typeof n?r.forEach(function(t){Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}):"string"==typeof n&&(e=JSON.parse(n)),e.fps=h(e.fps),e.videoConstraints?e.videoConstraints=p(e.videoConstraints):e.videoConstraints={},e)}function g(t,e,n){var r,o;e=f(e),n||(n={}),r=e.videoConstraints,o=function(t){var e,n;n={};try{"string"==typeof t?n.deviceId=t:n.deviceId=null!=(e=t.deviceId)?e.exact:void 0}catch(t){l.VERBOSE&&console.error("error in getting deviceId",t)}return n}(t),r.deviceId=o.deviceId,n[u.CAMERA]=JSON.stringify(r),sessionStorage.setItem(u.IMPLEMENTATION_TYPE,JSON.stringify(n))}var m=function(){var t,e,n;function r(t,e){if(this.formatMap=new Map,t instanceof Map)for(var n=0,r=Array.from(t.keys());n<r.length;n++){var o=r[n],i=t.get(o);this.formatMap.set(o,i)}this.isAztecEnabled=!!e&&e.indexOf(2)>=0,this.isCodaBarEnabled=!!e&&e.indexOf(1)>=0,this.isCode39Enabled=!!e&&e.indexOf(0)>=0,this.isCode93Enabled=!!e&&e.indexOf(3)>=0,this.isCode128Enabled=!!e&&e.indexOf(4)>=0,this.isDataMatrixEnabled=!!e&&e.indexOf(5)>=0,this.isMaxiCodeEnabled=!!e&&e.indexOf(6)>=0,this.isItfEnabled=!!e&&e.indexOf(7)>=0,this.isEan13Enabled=!!e&&e.indexOf(8)>=0,this.isEan8Enabled=!!e&&e.indexOf(9)>=0,this.isPdf417Enabled=!!e&&e.indexOf(10)>=0,this.isRss14Enabled=!!e&&e.indexOf(11)>=0,this.isRssExpandedEnabled=!!e&&e.indexOf(12)>=0,this.isUpcAEnabled=!!e&&e.indexOf(13)>=0,this.isUpcEEnabled=!!e&&e.indexOf(14)>=0,this.isUpcEanExtensionEnabled=!!e&&e.indexOf(15)>=0,this.isMsiEnabled=!!e&&e.indexOf(16)>=0,this.isPlesseyEnabled=!!e&&e.indexOf(17)>=0,this.isI2O5Enabled=!!e&&e.indexOf(18)>=0,this.isQrCodeEnabled=!!e&&e.indexOf(19)>=0||!e}return t=r,(e=[{key:"isFormatEnabled",value:function(t){return!!this.formatMap.get(t)}},{key:"getSupportedFormats",value:function(){var t=[];for(var e=0,n=Array.from(this.formatMap.keys());e<n.length;e++){var r=n[e];this.formatMap.get(r)&&t.push(r)}return t}}])&&b(t.prototype,e),n&&b(t,n),r}();function v(t,e){var n;switch(t){case 0:n="QR_CODE";break;case 1:n="AZTEC";break;case 2:n="CODABAR";break;case 3:n="CODE_39";break;case 4:n="CODE_93";break;case 5:n="CODE_128";break;case 6:n="DATA_MATRIX";break;case 7:n="MAXICODE";break;case 8:n="ITF";break;case 9:n="EAN_13";break;case 10:n="EAN_8";break;case 11:n="PDF_417";break;case 12:n="RSS_14";break;case 13:n="RSS_EXPANDED";break;case 14:n="UPC_A";break;case 15:n="UPC_E";break;case 16:n="UPC_EAN_EXTENSION";break;default:n="UNKNOWN"}return{decodedText:e,format:{format:t,formatName:n}}}function S(t){return{decodedText:t,format:null}}var b=function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}},(i=(a=i||{})[a.NOT_STARTED=0]="NOT_STARTED",a[a.SCANNING=1]="SCANNING",a[a.PAUSED=2]="PAUSED",a[a.UNKNOWN=3]="UNKNOWN",i),y=/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);function w(t){var e;if(t&&t.length)return t.length||(e="You can only scan one file at a time"),e}function T(t,e){var n;if(t&&t.length)return(n=t[0]).name||(n.name="file"),n.type.split("/")[0].toLowerCase()!==e.toLowerCase()&&console.error("Failure: File format not supported"),n}function _(t){return URL.createObjectURL(t)}var C=function(){var t,e,n;function r(t,e){void 0===e&&(e=!1),this.qrcode=window.qrcode,this.elementId=t,this.verbose=e,this.isScanning||this.element}return t=r,(e=[{key:"element",get:function(){return document.getElementById(this.elementId)}},{key:"isScanning",get:function(){return this.qrcode.isScanning}},{key:"clear",value:function(){this.qrcode.clear()}},{key:"scanFile",value:function(t,e){var n=this;void 0===e&&(e=!0);var r=w(t.files);if(r)throw r;var o=T(t.files,"image");if(!o)throw"File format not supported";var i=_(o);return new Promise(function(t,r){n.qrcode.callback=function(e){"string"!=typeof e||e.startsWith("error")?r(e):t(e)},n.qrcode.decode(i)})}},{key:"scanFileV2",value:function(t,e){var n=this;return new Promise(function(r,o){var i=w(t.files);if(i)return o(i);var a=T(t.files,"image");if(!a)return o("File format not supported");var s=_(a);n.qrcode.callback=function(t){var e;t?(e=S(t),r({decodedText:e.decodedText,decodedResult:e})):o("QR code not found.")},n.qrcode.decode(s)})}},{key:"scanFileV3",value:function(t,e){var n=this;return new Promise(function(r,o){var i=w(t.files);if(i)return o(i);var a=T(t.files,"image");if(!a)return o("File format not found");var s=_(a);n.qrcode.callback=function(t){var e;null===t?(o("QR code not found."),r()):(e=S(t),r({decodedText:e.decodedText,decodedResult:e}))},n.qrcode.decode(s)})}},{key:"toString",value:function(){return"Html5Qrcode"}},{key:"stop",value:function(){if(this.localMediaStream){for(var t=0,e=this.localMediaStream.getTracks();t<e.length;t++){e[t].stop()}this.localMediaStream=void 0}this._shouldScan=!1,this.videoElement&&this.videoElement.srcObject&&(this.videoElement.srcObject=null),this.elementController.clear()}},{key:"start",value:function(t,e,n,r){var o=this;if(!t)throw"cameraIdOrConfig parameter is required";if(!n||"function"!=typeof n)throw"qrCodeSuccessCallback is required and must be a function.";r||(r=console.log);var i=this.element;if(!i)throw"HTML Element with id="+this.elementId+" not found";var a=f(e);return this._shouldScan=!0,this.elementController=new k(i,this.verbose),new Promise(function(e,s){o.setup(a).then(function(i){o.videoElement=i,o.elementController.setup(o.videoElement,a),e(null),g(t,a),navigator.mediaDevices.getUserMedia({audio:!1,video:a.videoConstraints}).then(function(e){o.localMediaStream=e,o.videoElement.srcObject=e,o.videoElement.onloadedmetadata=function(){o.videoElement.play(),o.scan(n,r)}}).catch(function(t){s("Error getting user media: "+t)})}).catch(s)})}},{key:"setup",value:function(t){return new Promise(function(e,n){var r,o,i;r=document.createElement("video"),o="video-stream",i="html5-qrcode-video",r.style.width="100%",r.style.height="100%",r.setAttribute("id",o),r.setAttribute("class",i),r.setAttribute("playsinline",!0),r.muted=!0,e(r)})}},{key:"scan",value:function(t,e){var n=this;if(this._shouldScan){var r=this.elementController.getCanvas();this.qrcode.width=r.width,this.qrcode.height=r.height,this.qrcode.imagedata=this.elementController.getScanRegion(r),this.qrcode.decode(null);try{this.qrcode.callback=function(e){"string"!=typeof e||e.startsWith("error")?e.startsWith("error")&&e.endsWith("found")||e&&l.VERBOSE&&console.log(e):t(e),n.elementController.possiblyUpdateShadedRegion(n.qrcode.getPoints()),n.elementController.possiblyUpdateShadedRegion(n.qrcode.getPoints()),setTimeout(function(){return n.scan(t,e)},h(n.config.fps))}}catch(t){e("QR code parse error, error = "+t)}}}}])&&b(t.prototype,e),n&&b(t,n),r}(),k=function(){var t,e,n;function r(t,e){this.rootElement=t,this.verbose=e}return t=r,(e=[{key:"setup",value:function(t,e){this.config=e,this.videoElement=t;var n=d(this.config.qrbox);this.qrboxSize=function(t,e,n){var r,o,i;if(l.VERBOSE)return console.log(t,e,n),o={},r=function(t,e,n){var r,o;return"number"==typeof(o=t)?(r=e,o>r&&(console.warn("`qrbox` value is expected to be smaller than the video width."),o=r),o):"object"==typeof o?(o.width>e&&(console.warn("`qrbox.width` value is expected to be smaller than the video width."),o.width=e),o.height>n&&(console.warn("`qrbox.height` value is expected to be smaller than the video height."),o.height=n),o):void 0}(n,e,t),i="number"==typeof r?{width:r,height:r}:r,l.VERBOSE&&console.log(i),o.width=i.width,o.height=i